# competence\_frontend presentation

## Structure

```
competence-frontend/
├── node_modules/         ✅ centralized deps
├── packages/
│   ├── react-app/
│   ├── shared/
│   └── competence-wd/
├── package.json
```

### 🧠 My NPM Monorepository structure in competence\_frontend

| Location                               | Purpose                                     |
| -------------------------------------- | ------------------------------------------- |
| `root/node_modules/`                   | Core deps (React, TypeScript, shared tools) |
| `packages/react-app/.next/`            | Next.js build output                        |
| `packages/competence-wd/node_modules/` | WordPress block compiler toolchain          |

#### ✅ Root `node_modules/`

This holds **shared dependencies** across all workspaces.

* Installed when you run `npm install` from the monorepo root.
* Ideal place for `react`, `typescript`, `@types/node`, etc.

#### ✅ `.next/` in `react-app`

* Generated by Next.js when you run `npm run dev` or `build`
* This is the app’s compiled output. It’s **normal and required**.

#### ✅ Local `node_modules/` in `competence-wd`

**For WordPress blocks**:

* WordPress blocks **require their own build process** using `@wordpress/scripts`
* `@wordpress/scripts` has a lot of dependencies (Babel, Webpack, PostCSS, etc.)
* It’s isolated and doesn’t conflict with React or Shared code

💡 `@wordpress/scripts` is not something you want in your global root `node_modules/` unless **all** apps are WordPress blocks (which they aren't).

Installed in `competence-wd` with:

```bash
cd packages/competence-wd
npm install @wordpress/scripts --save-dev
```

`@wordpress/scripts` is only needed for:

* The WordPress plugin (`competence-wd`)
* Not needed in `react-app` or `shared/`
* Keeps build tools modular and efficient

---

## Install

### Prerequisite

Install required build tools:

```bash
npm install --save-dev typescript@5.2 @types/node@18
```

### 1. Initial Install

Clone and initialize:

```bash
git clone <repo-url>
cd competence-frontend

# Install shared dependencies from monorepo root:
npm install
```

Then install WordPress block compiler tools:

```bash
cd packages/competence-wd
npm install @wordpress/scripts --save-dev
```

### 2. Clean & Reinstall (Full Reset)

Run this if you suspect bad installs (e.g., local node\_modules in sub-packages):

```bash
# From monorepo root
cd competence-frontend
rm -rf ./packages/*/node_modules ./packages/*/package-lock.json

# Reinstall from root
npm install --save-dev typescript@5.3 @types/node@20
npm install

# Reinstall WordPress scripts
cd packages/competence-wd
npm install @wordpress/scripts --save-dev

# Check version
cd packages/shared
npx tsc --version
```

### Shared Package: Build

To compile the shared package:

```bash
cd packages/shared
npm run build
```

---

### 3. Initialization (History of this project skeleton creation)

At the beginning of the world, the project was empty.
There was no directory, no npm, nothing...
This is the story of how `competence_frontend` was born:

### Prerequisite

```bash
sudo apt install node-typescript
```

### competence\_frontend root

```bash
mkdir competence_frontend
cd competence_frontend
mkdir -p packages/{react-app,shared,wd-plugin}
npm install --save-dev typescript@5.3 @types/node@20
```

### shared

```bash
# In competence_frontend
mkdir -p packages/shared/{components,api,utils,types}
cd packages/shared
npm init -y
npm install react react-dom
```

### react-app

```bash
# In competence_frontend
cd packages/react-app
npx create-next-app@latest . --typescript
npm install @competence/shared
```

### wordpress plugin

#### from plugin mono block to multiblock 

first we create a plugin mono block project
```bash
# In competence_frontend/packages/
npx @wordpress/create-block competence-wd
cd packages/competence-wd
npm install @wordpress/scripts --save-dev
cd ../..
npm install
```
Then we switch to plugin multiblock, goal is to have this structure:
 
```
competence-wd/
├── competence-wd.php
│   ├── index.js              ← register all blocks
│   ├── block-login/
│   │   ├── block.json
│   │   ├── edit.js
│   │   └── ...
│   ├── block-eleve/
│   │   └── ...
```
 
```bash
# competence_frontend
cd packages/competence-wd
mv src/competence-wd src/block-login
touch  src/index.js 
# Update block.json inside block-login:
{
  "name": "competence-wd/block-login",
  "title": "Login Block",
  ...
}
#In src/index.js, change to:
import './block-login';

```
#### add a new block in the same plugin

```bash
# in competence-frontend/
 
cd packages/competence-wd/ 
npx @wordpress/create-block block-eleve --namespace=competence-wd --no-plugin
mv block-eleve src
echo "import './block-eleve';" >> src/index.js
```

#### make a plugin zip and load in wordpress

##### build
```bash
npm run build
```
